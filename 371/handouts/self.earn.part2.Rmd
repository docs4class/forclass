---
title: 'R: Self Learn Basics Part Deaux'
author: "Tobin Turner"
date: "2/10/2021"
output: 
  html_document:
    number_sections: true
---
# Let's learn us some MORE R

## Attaching to objects
R includes a number of datasets that it is convenient to use for examples. You can get a description
of what's available by typing

```{r}
data()
```

To access any of these datasets, you then type data(dataset) where dataset is the name of the
dataset you wish to access. For example,

```{r}
data(trees)
trees[1:5,]
```



gives us the first 5 rows of these data, and we can now see that the columns represent measurements
of girth, height and volume of trees (actually cherry trees: see help(trees)) respectively. Now, if we want to work on the columns of these data, we can use the subscripting technique
explained above: for example, trees[,2] gives all of the heights. This is a bit tedious however, and
it would be easier if we could refer to the heights more explicitly. We can achieve this by attaching
to the trees dataset:

```{r}
attach(trees)
```


Eectively, this makes the contents of trees a directory, and if we type the name of an ob ject, R
will look inside this directory to nd it. Since Height is the name of one of the columns of trees, R now recognises this ob ject when we type the name. Hence, for example,

```{r}
mean(Height)
mean(trees[,2])
```


are synonymous, while it is easier to remember exactly what calculation is being performed by
the rst of these expressions. In actual fact, trees is an ob ject called a dataframe, essentially a
matrix with named columns (though a dataframe, unlike a matrix, may also include non-numerical
variables, such as character names). Because of this, there is another equivalent syntax to extract,
for example, the vector of heights:

```{r}
trees$Height
```


which can also be used without having rst attached to the dataset.

## Exercises

1. Attach to the dataset quakes and produce a statistical summary of the variables depth and
mag.
2. Attach to the dataset mtcars and nd the mean weight and mean fuel consumption for
vehicles in the dataset (type help(mtcars) for a description of the variables available).

## The apply function

It is possible to write loops in R, but they are best avoided whenever possible. A common situation
is where we want to apply the same function to every row or column of a matrix. For example,
we may want to nd the mean value of each variable in the trees dataset. Obviously, we could
operate on each column separately but this can be tedious, especially if there are many columns.
The function apply simplifies things. It is easiest understood by example:

```{r}
apply(trees,2,mean)
```

has the effect of calculating the mean of each column (dimension 2) of trees. We'd have used a 1
instead of a 2 if we wanted the mean of every row.
Any function can be applied in this way, though if optional arguments to the function are
required these need to be specied as well - see help(apply) for further details.
Exercise
1. Repeat the analyses of the datasets quakes and mtcars using the function apply to simplify
the calculations.
2. If
y =
"
1 4 1
0 2 1 #
what is the result of apply(y[,2:3],1,mean)? Check your answer in R.
1
7 Statistical Computation and Simulation
Many of the tedious statistical computations that would once have had to have been done from
statistical tables can be easily carried out in R. This can be useful for nding condence intervals
etc. Let's take as an example the Normal distribution. There are functions in R to evaluate
the density function, the distribution function and the quantile function (the inverse distribution
function). These functions are, respectively, dnorm, pnorm and qnorm. Unlike with tables, there is
no need to standardize the variables rst. For example, suppose X  N(3; 22
), then
> dnorm(x,3,2)
will calculate the density function at points contained in the vector x (note, dnorm will assume
mean 0 and standard deviation 1 unless these are specied. Note also that the function assumes
you will give the standard deviation rather than the variance. As an example
> dnorm(5,3,2)
[1] 0.1209854
evaluates the density of the N(3; 4) distribution at x = 5. As a further example
> x<-seq(-5,10,by=.1)
> dnorm(x,3,2)
calculates the density function of the same distribution at intervals of 0.1 over the range [5; 10].
The functions pnorm and qnorm work in an identical way - use help for further information.
Similar functions exist for other distributions. For example, dt, pt and qt for the t-distribution,
though in this case it is necessary to give the degrees of freedom rather than the mean and standard
deviation. Other distributions available include the binomial, exponential, Poisson and gamma,
though care is needed interpreting the functions for discrete variables.
One further important technique for many statistical applications is the simulation of data
from specied probability distributions. R enables simulation from a wide range of distributions,
using a syntax similar to the above. For example, to simulate 100 observations from the N(3; 4)
distribution we write
> rnorm(100,3,2)
Similarly, rt, rpois for simulation from the t and Poisson distributions, etc.
Exercises
1. Suppose X  N(2; 0:25). Denote by f and F the density and distribution functions of X
respectively. Use R to calculate
(a) f (0:5)
(b) F (2:5)
(c) F 1
(0:95) (recall that F 1
is the quantile function)
(d) Pr(1  X  3)
2. Repeat question 1 in the case that X has a t-distribution with 5 degrees of freedom.
3. Use the function rpois to simulate 100 values from a Poisson distribution with a parameter
of your own choice. Produce a statistical summary of the result and check that the mean and
variance are in reasonable agreement with the true population values.
4. Repeat the previous question replacing rpois with rexp.
8 Graphics
R has many facilities for producing high quality graphics. A useful facility before beginning is to
divide a page into smaller pieces so that more than one gure can be displayed. For example:
> par(mfrow=c(2,2))
creates a window of graphics with 2 rows and 2 columns. With this choice the windows are lled
up row-wise. Use mfcol instead of mfrow to ll up column-wise. The function par is a general
function for setting graphical parameters. There are many options: see help(par).
Histogram of Height
Height
Frequency
60 65 70 75 80 85 90
0 2 4 6 8 10
65 70 75 80 85
Histogram of Volume
Volume
Frequency
10 20 30 40 50 60 70 80
0 2 4 6 8 10
10 20 30 40 50 60 70
Figure 1: Tree heights and volumes
So, for example
> par(mfrow=c(2,2))
> hist(Height)
> boxplot(Height)
> hist(Volume)
> boxplot(Volume)
> par(mfrow=c(1,1))
produces Figure 1. Note the nal use of par to return the graphics window to standard size.
65 70 75 80 85
10 20 30 40 50 60 70
Height
Volume
Figure 2: Scatterplot of tree heights and volumes
We can also plot one variable against another using the function plot:
> plot(Height,Volume)
12
Girth
65 70 75 80 85
8 10 12 14 16 18 20
65 70 75 80 85
Height
8 10 12 14 16 18 20 10 20 30 40 50 60 70
10 20 30 40 50 60 70
Volume
Figure 3: Scatterplot matrix for tree data
See Figure 2.
R can also produce a scatterplot matrix (a matrix of scatterplots for each pair of variables)
using the function pairs:
> pairs(trees)
See Figure 3. Like many other functions plot is ob ject-specic: its behaviour depends on the
ob ject to which it is applied. For example, if the ob ject is a matrix, plot is identical to pairs: try
plot(trees). For some other possibilities try:
> data(nhtemp)
> plot(nhtemp)
> data(faithful)
> plot(faithful)
> data(HairEyeColor)
> plot(HairEyeColor)
There are also many optional arguments in most plotting functions that can be used to control
colours, plotting characters, axis labels, titles etc. The functions points and lines are useful for
adding points and lines respectively to a current graph. The function abline is useful for adding
a line with specied intercept and slope.
To print a graph, point the cursor over the graphics window and press the right button on the
mouse. This should open up a menu which includes `print' as an option. You also have the option
to save the gure in various formats, for example as a postscript le, for storage and later use.
Exercises
1. Use
> x<-rnorm(100)
or something similar, to generate some data. Produce a gure showing a histogram and
boxplot of the data. Modify the axis names and title of the plot in an appropriate way.
2. Type the following
13
> x<- (-10):10
> n<-length(x)
> y<-rnorm(n,x,4)
> plot(x,y)
> abline(0,1)
Try to understand the eect of each command and the graph that is produced.
3. Type the following:
> data(nhtemp)
> plot(nhtemp)
This produces a time series plot of measurements of annual mean temperatures in New Hampshire, U.S.A.
4. The previous example illustrated that plot acts dierently on ob jects of dierent types - the
ob ject nhtemp has the special class time series. More generally, we may have the data of
yearly observations in a vector, but need to build the time series plot for ourselves. We can
mimic this situation by typing
> temp<-as.vector(nhtemp)
which creates a vector temp that contains only the annual temperatures. We can produce
something similar to the time series plot by typing
> plot(1912:1971,temp)
but this plots points rather than lines. To join the data via lines we would use
> plot(1912:1971,temp,type='l')
instead. To get points and lines, use type='b' instead.
